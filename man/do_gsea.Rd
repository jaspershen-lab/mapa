% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/9_do_gesa.R
\name{do_gsea}
\alias{do_gsea}
\title{Perform Gene Set Enrichment Analysis (GSEA) for multi-omics data}
\usage{
do_gsea(
  variable_info,
  order_by = "fc",
  omic_type = c("transc", "met"),
  database,
  save_to_local = FALSE,
  path = "result",
  OrgDb,
  organism = "hsa",
  keyType = "ENTREZID",
  exponent = 1,
  eps = 1e-10,
  verbose = TRUE,
  seed = FALSE,
  by = "fgsea",
  use_internal_data = FALSE,
  ont,
  pvalueCutoff = 0.05,
  pAdjustMethod = "BH",
  qvalueCutoff = 0.2,
  minGSSize = 10,
  maxGSSize = 500,
  readable = FALSE,
  ...
)
}
\arguments{
\item{variable_info}{A data.frame containing feature information with required identifiers:
- For metabolomics: 'keggid' (KEGG compound IDs) and/or 'hmdbid' (HMDB IDs)
- For transcriptomics: 'entrezid' (Entrez Gene IDs)}

\item{order_by}{Character specifying the column in variable_info to use for ranking features.
Typically contains fold change values. Must be specified. Default is 'fc'.}

\item{omic_type}{Analysis type: "transc" for transcriptomics or "met" for metabolomics.
Mandatory parameter with no default.}

\item{database}{Character vector specifying databases to use:
- For "transc": c("go", "kegg", "reactome")
- For "met": c("kegg", "hmdb")}

\item{save_to_local}{Logical indicating whether to save results to local files.
Default is \code{FALSE}.}

\item{path}{Output directory path when save_to_local=TRUE.
Default is \code{"result"}.}

\item{OrgDb}{Annotation database (e.g., org.Hs.eg.db). Required for transcriptomics GO analysis. Required if \code{"go"} is included in \code{database}.}

\item{organism}{Organism code. Supported: "hsa" (human), "rno" (rat), "mmu" (mouse), etc.
Default is \code{"hsa"}.}

\item{keyType}{ID type for transcriptomics (default is \code{"ENTREZID"}).}

\item{exponent}{Weighting exponent for GSEA (default is \code{1}).}

\item{eps}{Numeric threshold for p-value adjustment (default is \code{1e-10}).}

\item{verbose}{Logical controlling progress messages (default is \code{TRUE}).}

\item{seed}{Logical/numeric for reproducibility (default is \code{FALSE}).}

\item{by}{Algorithm selection (\code{"fgsea"} for fast implementation, default).}

\item{use_internal_data}{Logical to use KEGG internal data (default is \code{FALSE}).}

\item{ont}{GO ontology type (\code{"BP"}, \code{"MF"}, or \code{"CC"}). Required for GO analysis.}

\item{pvalueCutoff}{Adjusted p-value cutoff (default is \code{0.05}).}

\item{pAdjustMethod}{P-value adjustment method (default is \code{"BH"}).}

\item{qvalueCutoff}{q-value cutoff (default is \code{0.2}).}

\item{minGSSize}{Minimum gene set size (default is \code{10}).}

\item{maxGSSize}{Maximum gene set size (default is \code{500}).}

\item{readable}{Logical for converting IDs to gene symbols (default is \code{FALSE}).}

\item{...}{Additional parameters passed to internal functions.}
}
\value{
An object of class \code{functional_module} containing the enrichment analysis results.
}
\description{
This integrated function performs GSEA for both transcriptomics and metabolomics data:
\itemize{
\item \strong{Transcriptomics} (omic_type = "transc"):
Supports GO/KEGG/Reactome databases. Requires Entrez IDs and fold change values.

\item \strong{Metabolomics} (omic_type = "met"):
Supports KEGG/HMDB metabolic pathways. Requires KEGG IDs, HMDB IDs and fold change values.
}
}
\examples{
\dontrun{
# Transcriptomics example
library(org.Hs.eg.db)
data(gene_data) # Contains entrezid and fc columns
result_transc <- do_gsea(
  omic_type = "transc",
  variable_info = gene_data,
  database = c("go", "kegg"),
  OrgDb = org.Hs.eg.db,
  organism = "hsa"
)

# Metabolomics example
data(met_data) # Contains keggid and fc columns
result_met <- do_gsea(
  omic_type = "met",
  variable_info = met_data,
  database = "kegg",
  organism = "hsa"
)

# Extract KEGG pathway results
kegg_res <- result_met@enrichment_metkegg_result
}

}
\author{
Xiaotao Shen \email{xiaotao.shen@outlook.com}
}
