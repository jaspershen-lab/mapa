% Generated by roxygen2: do not edit by hand
% Please edit documentation in
%   R/15_data_visualization_plot_relationship_heatmap.R
\name{plot_relationship_heatmap}
\alias{plot_relationship_heatmap}
\title{Plot a Combined Relationship Network, Heatmap, and Word Cloud}
\usage{
plot_relationship_heatmap(
  object,
  level = c("pathway", "molecule"),
  expression_data,
  module_content_number_cutoff = NULL,
  module_ids = NULL,
  scale_expression_data = TRUE,
  dist_method = "euclidean",
  hclust_method = "complete",
  cluster_rows = FALSE,
  show_cluster_tree = TRUE,
  wordcloud = TRUE,
  llm_text = FALSE,
  functional_module_position_limits = c(0.2, 0.8),
  pathway_position_limits = c(0.1, 0.9),
  molecule_position_limits = c(0, 1),
  functional_module_color = "#DD4124FF",
  pathway_color = "#43B284FF",
  molecule_color = "#FAB255FF",
  functional_module_text = TRUE,
  pathway_text = TRUE,
  molecule_text = FALSE,
  text_size = 3,
  text_col = c("#FE9B00FF", "#D8443CFF", "#9B3441FF", "#DE597CFF", "#E87B89FF",
    "#E6A2A6FF", "#AA7AA1FF", "#9F5691FF", "#633372FF", "#1F6E9CFF", "#2B9B81FF",
    "#92C051FF"),
  num_text_show = 15,
  min_font_size = 8,
  max_font_size = 12,
  text_box_color = "grey",
  text_box_fill = "white",
  text_box_width = 4
)
}
\arguments{
\item{object}{A \strong{functional_module} object containing analysis results.}

\item{level}{Character string selecting the visualisation level;
must be \code{"pathway"} or \code{"molecule"}. Defaults to \code{"pathway"}.}

\item{expression_data}{A data frame of expression values. It must
contain an \code{id} column (ENSEMBL for genes/proteins, HMDB ID or
KEGG ID for metabolites) followed by one column per sample/group.}

\item{module_content_number_cutoff}{Optional numeric cutoff; keep
only modules with more pathways than this value.}

\item{module_ids}{Optional character vector of module IDs to plot.
When supplied, \code{module_content_number_cutoff} is ignored.}

\item{scale_expression_data}{Logical; if \code{TRUE} (default) the heat‑map
matrix is scaled row‑wise.}

\item{dist_method}{Distance metric for clustering heat‑map rows when
\code{level = "molecule"} and \code{cluster_rows = TRUE}. Passed to
\code{\link[stats:dist]{stats::dist()}}. Default is \code{"euclidean"}.}

\item{hclust_method}{Agglomeration method for hierarchical clustering
when \code{level = "molecule"} and \code{cluster_rows = TRUE}. Passed to
\code{\link[stats:hclust]{stats::hclust()}}. Default is \code{"complete"}.}

\item{cluster_rows}{Logical; if \code{TRUE}, molecules (rows) are clustered
in the heat‑map when \code{level = "molecule"}. Defaults to \code{TRUE}.}

\item{show_cluster_tree}{Logical; when \code{level = "molecule"} and
\code{cluster_rows = TRUE}, controls whether the row dendrogram is shown
(\code{TRUE}, default) or hidden (\code{FALSE}).}

\item{wordcloud}{Logical; if \code{TRUE} (default) a word‑cloud is drawn
for each module and displayed as a row annotation (only when
\code{level = "pathway"}).}

\item{llm_text}{Logical; if \code{TRUE}, the word‑cloud is built from
LLM‑generated summaries, otherwise from concatenated pathway
descriptions. Defaults to \code{FALSE}.}

\item{functional_module_position_limits, pathway_position_limits, molecule_position_limits}{Numeric length‑2 vectors setting the
relative x‑axis span for the respective node types. Defaults are
\code{c(0.2, 0.8)}, \code{c(0.1, 0.9)} and \code{c(0, 1)}.}

\item{functional_module_color, pathway_color, molecule_color}{Colours
for the three node classes. Defaults are
\code{"#DD4124FF"}, \code{"#43B284FF"}, and \code{"#FAB255FF"}.}

\item{functional_module_text, pathway_text, molecule_text}{Logical flags
controlling whether text labels are drawn for each node class.
Defaults are \code{TRUE}, \code{TRUE}, and \code{FALSE} respectively.}

\item{text_size}{Numeric font size for node labels. Default is \code{3}.}

\item{text_col}{A vector of colours to cycle through in the word‑cloud
(only for \code{level = "pathway"}). Default is a palette from
\strong{MetBrewer::Signac}.}

\item{num_text_show, max_font_size, min_font_size}{Word‑cloud layout
controls. Show up to \code{num_text_show} words (default 15) with font
sizes scaled between \code{min_font_size} (8) and \code{max_font_size} (12).}

\item{text_box_color, text_box_fill, text_box_width}{Appearance of the
annotation box that contains each word‑cloud. Defaults are
\code{"grey"}, \code{"white"}, and \code{4} cm.}
}
\value{
A \strong{patchwork} object combining the network graph and
heat‑map, ready for further composition or direct plotting.
}
\description{
Create a composite visual that links a bipartite/tripartite network
of functional modules, pathways and/or molecules to an expression
heat‑map, with optional word‑cloud annotations that summarise each
functional module.
}
\details{
\strong{Pathway level} – edges connect functional modules to their
pathways. The heat‑map shows the mean expression of molecules within
each pathway and optional word‑clouds give functional summaries.

\strong{Molecule level} – edges connect modules → pathways → individual
molecules. The heat‑map displays each molecule’s expression profile.
Row clustering and dendrogram display can be toggled with
\code{cluster_rows} and \code{show_cluster_tree}.

The network layout is manually spaced to improve readability.
}
\examples{
\dontrun{
# Load data
load("demo_data/input_data.rda")
load("demo_data/llm_interpreted_functional_module.rda")

# Pathway‑level visual
plot_relationship_heatmap(
  object      = llm_interpreted_functional_module,
  level       = "pathway",
  expression_data = input_data,
  module_content_number_cutoff = 5
)

# Molecule‑level visual with clustering
plot_relationship_heatmap(
  object      = llm_interpreted_functional_module,
  level       = "molecule",
  expression_data = input_data,
  module_ids  = c("Functional_module_10", "Functional_module_25"),
  cluster_rows      = TRUE,
  show_cluster_tree = TRUE
)
}

}
\author{
Yifei Ge \href{mailto:yifeii.ge@outlook.com}{yifeii.ge@outlook.com}
}
