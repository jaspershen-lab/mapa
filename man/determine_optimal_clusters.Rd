% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_determine_optimal_clutsers.R
\name{determine_optimal_clusters}
\alias{determine_optimal_clusters}
\title{Determine Optimal Clustering Parameters for Pathway Enrichment Results}
\usage{
determine_optimal_clusters(
  object,
  cutoff_increment = 0.05,
  hclust_method = "complete"
)
}
\arguments{
\item{object}{An object containing pathway enrichment results. This can be a \code{list}
with \code{sim_matrix} and \code{enriched_pathway} elements, or a compatible S4 object
(see Details).}

\item{cutoff_increment}{A numeric value specifying the step size for the
similarity cutoff sequence, which ranges from 0.2 to 0.9. The default is 0.05.}

\item{hclust_method}{A character string for the agglomeration method used in
hierarchical clustering. Must be one of "ward.D", "ward.D2", "single",
"complete", "average", "mcquitty", "median", or "centroid".
Defaults to "complete".}
}
\value{
A list containing three elements:
\item{cluster_result}{A data frame in long format with the complete
evaluation results, including method, cutoff, metric type (modularity or
silhouette), and the calculated metric values.}
\item{evaluation_plot}{A \code{ggplot} object visualizing the validation metrics
across the range of similarity cutoffs for each clustering method, allowing
for easy comparison.}
\item{best_combination}{A data frame identifying the best-performing
method and cutoff combination for each metric. Note that ties for the top
score will result in multiple rows per metric.}
}
\description{
This function systematically evaluates various clustering strategies to identify the
optimal parameters for grouping pathway enrichment results. It iterates through
different clustering methods (hierarchical, binary cut, Girvan-Newman) and
a sequence of similarity cutoffs. Each parameter combination is assessed using
modularity and silhouette scores to quantify cluster quality.
}
\details{
The function handles two types of input for the \code{object} parameter:
\enumerate{
\item A \code{list} that must contain a pre-computed \code{sim_matrix} (a similarity matrix)
and an \code{enriched_pathway} object. This is typically used for results from
biotext embedding.
\item An S4 object generated by \code{mapa::merge_pathways()}function. In this case,
the function will first calculate a Jaccard similarity matrix internally
based on the overlapping genes/metabolites between pathways before
proceeding with the evaluation.
}
}
\examples{
\dontrun{
# Assuming 'enrichment_obj' is your S4 enrichment analysis result from mapa
# that has been processed by merge_pathways().
cluster_eval <- determine_optimal_clusters(enrichment_obj)

# View the evaluation plot to compare methods
print(cluster_eval$evaluation_plot)

# Check the best recommended parameter(s)
print(cluster_eval$best_combination)

# Run a more detailed search with a smaller cutoff increment
cluster_eval_fine <- determine_optimal_clusters(enrichment_obj,
                                                cutoff_increment = 0.01)

# Evaluate using a different hierarchical clustering agglomeration method
cluster_eval_ward <- determine_optimal_clusters(enrichment_obj,
                                                hclust_method = "ward.D2")
}

}
