% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_3_assess_clustering_quality.R
\name{assess_clustering_quality}
\alias{assess_clustering_quality}
\title{Assess Clustering Quality and Visualize Results}
\usage{
assess_clustering_quality(
  object,
  save_plot = FALSE,
  plot_path = "clustering_quality_plot.png",
  width = 12,
  height = 8,
  ignore_singleton = FALSE
)
}
\arguments{
\item{object}{A \code{functional_module} class object, which should be the result
of running the function \code{get_functional_modules()}.}

\item{save_plot}{A logical value indicating whether to save the generated plot
to a file. Defaults to \code{FALSE}. The plot saved is the \code{evaluation_plot}.}

\item{plot_path}{A character string specifying the file path where the plot
will be saved. Defaults to \code{"clustering_quality_plot.png"}.}

\item{width}{A numeric value for the width of the saved plot in inches.
Defaults to \code{12}.}

\item{height}{A numeric value for the height of the saved plot in inches.
Defaults to \code{8}.}

\item{ignore_singleton}{A logical value indicating whether to exclude singleton
modules (modules with only one node) from the quality assessment. Defaults to
\code{FALSE}.}
}
\value{
A list containing three elements:
\item{quality_metrics}{
A data frame providing detailed metrics for each node.
The columns include:
\itemize{
\item \code{module}: The identifier for the functional module.
\item \code{size}: The total number of nodes in the module.
\item \code{node}: The identifier for the individual node (e.g., gene or term).
\item \code{cluster}: The numeric cluster ID assigned to the node.
\item \code{neighbor}: The neighboring cluster used for silhouette width calculation.
\item \code{sil_width}: The silhouette width of the node, indicating how well it fits within its cluster.
}
}
\item{size_plot}{
A \code{ggplot} object displaying a bar chart of the module size distribution,
showing the number of nodes in each functional module.
}
\item{evaluation_plot}{
A \code{ggplot} object that visualizes the silhouette scores for all nodes in
the clusters. The plot title summarizes the overall clustering quality with:
\itemize{
\item Average silhouette score.
\item The proportion of modules that are non-singletons.
\item Calinski-Harabasz (CH) Index.
\item Davies-Bouldin (DB) Index.
}
}
}
\description{
This function evaluates the quality of functional module clustering. It computes
several standard clustering validation metrics, including the average silhouette
score, Calinski-Harabasz index, and Davies-Bouldin index.
}
\details{
The function operates on a \code{functional_module} object. It first identifies
and filters out singleton modules (modules with only one node).

Using the \code{sim} edge attribute from the object's graph data, it calculates a
distance matrix (\code{distance = 1 - similarity}). This matrix and the cluster
assignments are then used to compute the quality metrics.

The final output is a list containing the calculated metrics in a data frame
and multiple plots for visual assessment.
}
\examples{
\dontrun{
# Assuming 'enriched_functional_module' is a pre-existing object
# from get_functional_modules()

# Run the quality assessment
quality_results <- assess_clustering_quality(
  object = enriched_functional_module
)

# Print the evaluation plot to the console
print(quality_results$evaluation_plot)

# Print the module size distribution plot
print(quality_results$size_plot)

# Inspect the first few rows of the quality metrics table
head(quality_results$quality_metrics)
}

}
